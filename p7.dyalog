⎕IO←0 ⋄ q←⊃⎕NGET'p7.txt'1
up←{p s←⍺ ⋄ (1↓p)((s⊃⍨⊃p)+@(1⊃p)⊢s)f 1↓⍵} ⋄ cd←{(0,¨1 0+⍺)f 1↓⍵} ⋄ file←{p s←⍺ ⋄ p((⍎t↑⍨' '⍳⍨t←⊃⍵)+@0⊢s)f 1↓⍵}
f←{p s←⍺ ⋄ 1 0≡≢¨p⍵:s ⋄ (0=≢⍵)∨'$ cd ..'≡⊃⍵:⍺ up ⍵ ⋄ '$ cd'≡4↑⊃⍵:⍺ cd ⍵ ⋄ ⎕D∊⍨⊃⊃⍵:⍺ file ⍵ ⋄ ⍺∇1↓⍵} ⋄ s←⍬⍬ f q
+/s/⍨s≤1E5 ⍝ part 1
⌊/s/⍨s≥⊃⌽s-4E7 ⍝ part 2
