⎕IO←0 ⋄ ⎕PP←17
n←{⍎'0',⍵}¨¨¨'\d+'⎕S'&'¨¨p←(×≢¨p)⊆p←⊃⎕NGET'p11.txt'1
m←n{k←1⌈⊃2⊃⍺ ⋄ e←2⊃⍵ ⋄ (1⊃⍺)((1+∨/'* o'⍷e)(k*'*'∊e)(k×'+'∊e))(3⊃⍺)(∊¯2↑⍺)0}¨p
turn←{a b c d e←⍺⊃⍵ ⋄ e+←≢a←b ⍺⍺ a ⋄ t←0=c|a ⋄ (t/a)((~t)/a),⍨¨@(d,¨0)⊢(⊂⍬ b c d e)@⍺⊢⍵}
round←{⊃⍺⍺ turn/(⌽⍳≢⍵),⊂⍵}
f←{×/2↑{(⊂⍒⍵)⌷⍵}⊃∘⌽¨⍵}
f {a b c←⍺ ⋄ ⌊3÷⍨a*⍨b×c+⍵}round⍣20⊢m ⍝ part 1
y←⊃×/2⊃¨m ⋄ f {a b c←⍺ ⋄ y|a*⍨b×c+⍵}round⍣10000⊢m ⍝ part 2
