⎕IO←1 ⋄ p q←{⍵⊆⍨×≢¨⍵}⊃⎕NGET'p5.txt'1
p←~∘' '¨↓(0 1 0 0⍴⍨≢⊃p)⌿⍉↑1↓⊖p ⋄ q←⍎¨¨'\d+'⎕S'&'¨q
f←{(⍺↓¨⍵),¨⍺⍺¨⌽⍺↑¨⍵} ⋄ g←{(-⊃⍺)0⍺⍺f@(1↓⍺)⊢⍵}
⊃∘⌽¨⊃⌽g/(⌽q),⊂p ⍝ part 1
⊃∘⌽¨⊃⊢g/(⌽q),⊂p ⍝ part 2
